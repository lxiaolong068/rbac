# RBAC (Role-Based Access Control) ç³»ç»Ÿ

ä¸€ä¸ªåŸºäº Next.js 14 çš„ç°ä»£åŒ– RBAC æƒé™ç®¡ç†ç³»ç»Ÿï¼Œé‡‡ç”¨ App Router æ¶æ„å®ç°å…¨æ ˆå¼€å‘ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ” å®Œæ•´çš„ RBAC æƒé™æ§åˆ¶
  - ç»†ç²’åº¦çš„æƒé™ç®¡ç†
  - åŠ¨æ€æƒé™åˆ†é…
  - æƒé™ç»§æ‰¿æ”¯æŒ
  - å¤šç»´åº¦æƒé™æ ¡éªŒ
- ğŸš€ ç°ä»£åŒ–æŠ€æœ¯æ ˆ
  - Next.js 14 App Router
  - React Server Components
  - TypeScript ç±»å‹å®‰å…¨
  - Prisma ORM
- ğŸ¨ ä¼˜ç§€çš„ç”¨æˆ·ä½“éªŒ
  - Material UI + Tailwind CSS
  - å“åº”å¼è®¾è®¡
  - ä¸»é¢˜å®šåˆ¶
  - åŠ¨æ€è·¯ç”±
- ğŸ›¡ï¸ ä¼ä¸šçº§å®‰å…¨ä¿éšœ
  - XSS/CSRF é˜²æŠ¤
  - SQL æ³¨å…¥é˜²æŠ¤
  - å¯†ç åŠ å¯†å­˜å‚¨
  - æ•æ„Ÿæ•°æ®ä¿æŠ¤
- ğŸ“Š å®Œå–„çš„æ—¥å¿—ç³»ç»Ÿ
  - æ“ä½œæ—¥å¿—è®°å½•
  - æƒé™å˜æ›´è¿½è¸ª
  - ç™»å½•æ—¥å¿—
  - æ€§èƒ½ç›‘æ§
- ğŸ’¾ é«˜æ€§èƒ½æ•°æ®å­˜å‚¨
  - MySQL/PostgreSQL æ”¯æŒ
  - å¤šçº§ç¼“å­˜è®¾è®¡
  - è¯»å†™åˆ†ç¦»æ”¯æŒ
  - æ•°æ®åº“ç´¢å¼•ä¼˜åŒ–
- ğŸ§ª å®Œæ•´çš„æµ‹è¯•æ”¯æŒ
  - Jest å•å…ƒæµ‹è¯•
  - React Testing Library
  - E2E æµ‹è¯•æ”¯æŒ
  - æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š

## æŠ€æœ¯æ ˆ

### æ ¸å¿ƒæ¡†æ¶
- âœ… Next.js 14 (App Router)
- âœ… React 18
- âœ… TypeScript 5
- âœ… Prisma ORM

### å‰ç«¯æŠ€æœ¯
- âœ… Material UI
- âœ… Tailwind CSS
- âœ… React Query
- âœ… React Hook Form
- âœ… Zod éªŒè¯

### åç«¯æŠ€æœ¯
- âœ… Node.js
- âœ… MySQL/PostgreSQL
- âœ… Redis (å¯é€‰)
- âœ… JWT è®¤è¯

### å¼€å‘å·¥å…·
- âœ… ESLint
- âœ… Prettier
- âœ… Jest
- âœ… React Testing Library

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Node.js >= 18
- MySQL >= 8.0 æˆ– PostgreSQL >= 14
- pnpm >= 8.0
- Redis >= 6.0 (å¯é€‰)

### å®‰è£…æ­¥éª¤

1. å…‹éš†é¡¹ç›®
```bash
git clone https://github.com/your-username/rbac-system.git
cd rbac-system
```

2. å®‰è£…ä¾èµ–
```bash
pnpm install
```

3. ç¯å¢ƒé…ç½®
```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ–‡ä»¶
cp .env.example .env

# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œé…ç½®å¿…è¦çš„ç¯å¢ƒå˜é‡ï¼š
# DATABASE_URL="mysql://user:password@localhost:3306/rbac"
# JWT_SECRET="your-jwt-secret"
# NEXTAUTH_SECRET="your-nextauth-secret"
# NEXTAUTH_URL="http://localhost:3000"
# REDIS_URL="redis://localhost:6379" (å¯é€‰)
```

4. æ•°æ®åº“è¿ç§»
```bash
# ç”Ÿæˆè¿ç§»æ–‡ä»¶
pnpm prisma generate

# æ‰§è¡Œè¿ç§»
pnpm prisma migrate dev
```

5. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
```bash
pnpm dev
```

6. ç³»ç»Ÿåˆå§‹åŒ–
è®¿é—® http://localhost:3000ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æ£€æµ‹åˆå§‹åŒ–çŠ¶æ€ï¼š
- é¦–æ¬¡è®¿é—®æ—¶ä¼šè‡ªåŠ¨è·³è½¬åˆ°åˆå§‹åŒ–å‘å¯¼
- æŒ‰ç…§å‘å¯¼å®Œæˆç¯å¢ƒæ£€æŸ¥ã€æ•°æ®åº“é…ç½®å’Œç®¡ç†å‘˜è´¦æˆ·åˆ›å»º
- åˆå§‹åŒ–å®Œæˆåå³å¯ä½¿ç”¨ç®¡ç†å‘˜è´¦æˆ·ç™»å½•ç³»ç»Ÿ

### é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ app/          # Next.js 14 App Router è·¯ç”±
â”œâ”€â”€ components/   # React ç»„ä»¶
â”‚   â”œâ”€â”€ client/   # å®¢æˆ·ç«¯ç»„ä»¶
â”‚   â””â”€â”€ server/   # æœåŠ¡ç«¯ç»„ä»¶
â”œâ”€â”€ lib/          # å·¥å…·åº“
â”‚   â”œâ”€â”€ auth/     # è®¤è¯ç›¸å…³
â”‚   â”œâ”€â”€ cache/    # ç¼“å­˜ç³»ç»Ÿ
â”‚   â”œâ”€â”€ db/       # æ•°æ®åº“æ“ä½œ
â”‚   â””â”€â”€ logger/   # æ—¥å¿—ç³»ç»Ÿ
â”œâ”€â”€ types/        # TypeScript ç±»å‹å®šä¹‰
â””â”€â”€ middleware/   # Next.js ä¸­é—´ä»¶
```

## æ ¸å¿ƒåŠŸèƒ½

### ç³»ç»Ÿåˆå§‹åŒ–
- ç¯å¢ƒè‡ªæ£€
- æ•°æ®åº“é…ç½®æ£€æŸ¥
- ç®¡ç†å‘˜è´¦æˆ·è®¾ç½®
- åˆå§‹åŒ–çŠ¶æ€ç®¡ç†

### ç”¨æˆ·ç®¡ç†
- ç”¨æˆ· CRUD
- å¯†ç ç®¡ç†
- è§’è‰²åˆ†é…
- çŠ¶æ€ç®¡ç†

### è§’è‰²ç®¡ç†
- è§’è‰² CRUD
- æƒé™åˆ†é…
- è§’è‰²ç»§æ‰¿
- è§’è‰²åŒæ­¥

### æƒé™ç®¡ç†
- æƒé™ CRUD
- æƒé™ç»„
- æƒé™æ£€æŸ¥
- æƒé™ç¼“å­˜

### ç³»ç»ŸåŠŸèƒ½
- æ“ä½œæ—¥å¿—
- ç™»å½•æ—¥å¿—
- æ€§èƒ½ç›‘æ§
- ç³»ç»Ÿé…ç½®

## å¼€å‘æŒ‡å—

### ä»£ç è§„èŒƒ
```bash
# è¿è¡Œä»£ç æ£€æŸ¥
pnpm lint

# è¿è¡Œä»£ç æ ¼å¼åŒ–
pnpm format
```

### æµ‹è¯•
```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pnpm test

# è¿è¡Œç‰¹å®šæµ‹è¯•
pnpm test <æµ‹è¯•æ–‡ä»¶è·¯å¾„>

# ç”Ÿæˆæµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š
pnpm test:coverage
```

### æ„å»º
```bash
# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
pnpm build

# è¿è¡Œç”Ÿäº§ç‰ˆæœ¬
pnpm start
```

## éƒ¨ç½²æŒ‡å—

### ä¼ ç»Ÿéƒ¨ç½²
1. æ„å»ºé¡¹ç›®
```bash
pnpm build
```

2. é…ç½®ç”Ÿäº§ç¯å¢ƒå˜é‡
```bash
cp .env.example .env.production
# ç¼–è¾‘ .env.production
```

3. å¯åŠ¨æœåŠ¡
```bash
pnpm start
```

### Docker éƒ¨ç½²
```bash
# æ„å»ºé•œåƒ
docker build -t rbac-system .

# è¿è¡Œå®¹å™¨
docker run -p 3000:3000 rbac-system
```

## æ€§èƒ½ä¼˜åŒ–

- âœ… å¤šçº§ç¼“å­˜è®¾è®¡
- âœ… ç»„ä»¶æ‡’åŠ è½½
- âœ… å›¾ç‰‡ä¼˜åŒ–
- âœ… API è·¯ç”±ç¼“å­˜
- âœ… æ•°æ®é¢„å–
- âœ… é™æ€é¡µé¢ç”Ÿæˆ

## å®‰å…¨æªæ–½

- âœ… XSS é˜²æŠ¤
- âœ… CSRF é˜²æŠ¤
- âœ… SQL æ³¨å…¥é˜²æŠ¤
- âœ… å¯†ç åŠ å¯†
- âœ… è¯·æ±‚é™æµ
- âœ… ä¼šè¯ç®¡ç†

## è´¡çŒ®æŒ‡å—

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æäº¤ Pull Request

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶

## é—®é¢˜åé¦ˆ

å¦‚æœä½ å‘ç°äº† bug æˆ–æœ‰æ–°åŠŸèƒ½å»ºè®®ï¼Œæ¬¢è¿æäº¤ issueã€‚